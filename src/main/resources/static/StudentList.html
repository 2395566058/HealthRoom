<!DOCTYPE html>
<html lang="zh-Hans">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" conteng="width=device-width, initial-scale=1.0">
		<meta http-equiv="X-UA-Compatible" content="ie-edge">
		<title>学生后台管理系统</title>
		<link rel="stylesheet" href="https://cdn.bootcss.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
		 crossorigin="anonymous">
		<link rel="stylesheet" href="css/studentlist.css">
		<link rel="stylesheet" href="css/bootstrap-datetimepicker.min.css">
		<link rel="stylesheet" href="css/awesome-bootstrap-checkbox.css">
		<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
		 crossorigin="anonymous"></script>
		<script src="https://cdn.bootcss.com/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
		 crossorigin="anonymous"></script>
		<script src="https://cdn.bootcss.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
		 crossorigin="anonymous"></script>
		<script src="js/bootstrap-datetimepicker.min.js"></script>
		<script src="js/bootstrap-datetimepicker.js"></script>
		<script src="js/bootstrap-datetimepicker.fr.js"></script>
		<script src="js/studentlist.js"></script>
	</head>
	<body onselectstart="return false">
		<div class="component">
			<nav class="fixed-top nav">
				<div class="tittle">
					<span class="font-tittle1"><b>学生管理</b></span><span class="font-tittle2"><b>系统</b></span>
					<button class="btn btn-primary" onclick="logout()">退出</button>
				</div>
				<div class="list1">
					<div class="icon"><img src="img/StudentInfo.png" style="height: 50px; position: relative; top: 23px; left: 23px;"></div>
					<div class="sort-active">
						<p style="color: white;font-size: 20px;"><b>学生信息查询</b></p>
						<p style="margin-top: -20px;color: #FF8C8B;font-size: 16px;">0个分类</p>
					</div>
					<div class="line"></div>
				</div>
				<div class="list2">
					<a href="/BootCMS/Curriculum.action">
						<div class="icon"><img src="img/Schedule.png" style="height: 50px; position: relative; top: 23px; left: 23px;"></div>
						<div class="sort">
							<p style="color: white;font-size: 20px;"><b>课程管理</b></p>
							<p style="margin-top: -20px;color: #FF8C8B;font-size: 16px;">0个分类</p>
						</div>
					</a>
					<div class="line"></div>
				</div>
				<div class="list3">
					<a href="#">
						<div class="icon"><img src="img/Fix.png" style="height: 50px; position: relative; top: 23px; left: 23px;"></div>
						<div class="sort">
							<p style="color: white;font-size: 20px;"><b>学生报修请求管理</b></p>
							<p style="margin-top: -20px;color: #FF8C8B;font-size: 16px;">0个分类</p>
						</div>
					</a>
					<div class="line"></div>
				</div>
				<div class="list4">
					<a href="#">
						<div class="icon"><img src="img/Classroom.png" style="height: 50px; position: relative; top: 23px; left: 23px;"></div>
						<div class="sort">
							<p style="color: white;font-size: 20px;"><b>教室申请受理</b></p>
							<p style="margin-top: -20px;color: #FF8C8B;font-size: 16px;">0个分类</p>
						</div>
					</a>
					<div class="line"></div>
				</div>
			</nav>
		</div>

		<div class="content-body">
			<div class="menu">
				<div id="accordion">
					<div class="card">
						<div class="card-header">
							<a class="tittle-search" href="#collapse-1" data-toggle="collapse">筛选</a>
							<div class="tittle-add" onclick="startAdd()" data-toggle="modal" data-target="#info">添加</div>
							<div class="collapse" id="collapse-1" data-parent="#accordion">
								<div class="card-body">
									<!-- 名字 -->
									<button class="btn btn-secondar" data-toggle="modal" data-target="#name">姓名<span class="select-input" id="showName"></span></button>
									<div id="name" class="modal fade">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4 class="modal-title">筛选-姓名</h4>
													<button type="button" class="close" data-dismiss="modal">&times;</button>
												</div>
												<div class="modal-body">
													<input class="select-import" id="contentName" name="content" />
												</div>
												<div class="modal-footer">
													<button onClick="sunname()" class="btn btn-danger" data-dismiss="modal">确认</button>
												</div>
											</div>
										</div>
									</div>

									<!-- 入学时间 -->
									<button class="btn btn-secondar" data-toggle="modal" data-target="#admissiondate">入学<input readonly class="select-data"
										 id="showAdmissiondate" value="" /></button>
									<div id="admissiondate" class="modal fade">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4 class="modal-title">筛选-入学时间</h4>
													<button type="button" class="close" data-dismiss="modal">&times;</button>
												</div>
												<div class="modal-body">
													<div id="contentAdmissiondate" class="input-group date form_date col-md-5" data-date="" data-date-format="yyyy MM dd"
													 data-link-field="showAdmissiondate" data-link-format="yyyy-mm-dd">
														<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
														<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
													</div>
												</div>
												<div class="modal-footer">
													<button onClick="admissiondate()" class="btn btn-danger" data-dismiss="modal">确认</button>
												</div>
											</div>
										</div>
									</div>
								<script>
									$('.form_date').datetimepicker({
									        language:  'zh-Hans',
									        weekStart: 1,
									        todayBtn:  1,
											autoclose: 1,
											todayHighlight: 1,
											startView: 2,
											minView: 2,
											forceParse: 0
									    });
								</script>

									<!-- 出生年月 -->
									<button class="btn btn-secondar" data-toggle="modal" data-target="#born">生日<input readonly class="select-data"
										 id="showBorn" value="" /></button>
									<div id="born" class="modal fade">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4 class="modal-title">筛选-出生年月</h4>
													<button type="button" class="close" data-dismiss="modal">&times;</button>
												</div>
												<div class="modal-body">
													<div id="contentBorn" class="input-group date form_date col-md-5" data-date="" data-date-format="yyyy MM dd"
														 data-link-field="showBorn" data-link-format="yyyy-mm-dd">
														<span class="input-group-addon"><span class="glyphicon glyphicon-remove"></span></span>
														<span class="input-group-addon"><span class="glyphicon glyphicon-calendar"></span></span>
													</div>
												</div>
												<div class="modal-footer">
													<button onClick="born()" class="btn btn-danger" data-dismiss="modal">确认</button>
												</div>
											</div>
										</div>
									</div>
								<script>
									$('.form_date').datetimepicker({
									        language:  'zh-Hans',
									        weekStart: 1,
									        todayBtn:  1,
											autoclose: 1,
											todayHighlight: 1,
											startView: 2,
											minView: 2,
											forceParse: 0
									    });
								</script>

									<!--性别 -->
									<button class="btn btn-secondar" data-toggle="modal" data-target="#sex">性别<span class="select-input" id="showSex"></span></button>
									<div id="sex" class="modal fade">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4 class="modal-title">筛选-性别</h4>
													<button type="button" class="close" data-dismiss="modal">&times;</button>
												</div>
												<div class="modal-body">
													<div class="select-sex">
														<button onclick="sex1()" class="btn btn-success" id="contentSex1" value="男" data-dismiss="modal">男</button>
														<button onclick="sex2()" class="btn btn-success" id="contentSex2" value="女" data-dismiss="modal">女</button>
													</div>
												</div>
											</div>
										</div>
									</div>
	
									<!-- 所属专业 -->
									<button class="btn btn-secondar" data-toggle="modal" data-target="#major">专业<span class="select-input" id="showMajor"></span></button>
									<div id="major" class="modal fade">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4 class="modal-title">筛选-所属专业</h4>
													<button type="button" class="close" data-dismiss="modal">&times;</button>
												</div>
												<div class="modal-body">
													<input class="select-import" id="contentMajor" name="content" />
												</div>
												<div class="modal-footer">
													<button onClick="major()" class="btn btn-danger" data-dismiss="modal">确认</button>
												</div>
											</div>
										</div>
									</div>

									<!-- 联系电话 -->
									<button class="btn btn-secondar" data-toggle="modal" data-target="#phone">电话<span class="select-input" id="showPhone"></span></button>
									<div id="phone" class="modal fade">
										<div class="modal-dialog">
											<div class="modal-content">
												<div class="modal-header">
													<h4 class="modal-title">筛选-联系电话</h4>
													<button type="button" class="close" data-dismiss="modal">&times;</button>
												</div>
												<div class="modal-body">
													<input type="number" class="select-import" id="contentPhone" name="content" />
												</div>
												<div class="modal-footer">
													<button onClick="phone()" class="btn btn-danger" data-dismiss="modal">确认</button>
												</div>
											</div>
										</div>
									</div>

								<!-- 确认 -->
								<button class="btn btn-secondar"><img class="img-search" src="img/search.png" onclick="screen()"></button>
							</div>
						</div>
					</div>
				</div>
				<!-- 添加信息 -->
				<div class='modal fade' id="info" data-backdrop="static" >
						<div class='modal-dialog'>
							<div class='modal-content'>
								<div class='modal-body2'>
									<button type='button' onclick="exitAdd()" class='close2' data-dismiss='modal'>&times;</button>
									<div class='info-studenthead-shadow'>
										<input hidden onChange="changeFile(0)" type='file' id="avatar_file0" name='avatar_file' accept='image/gif, image/jpg, image/jpeg, image/png' 
											style="width: 100%;height:100%;opacity: 0;position: absolute;left:0;top: 0;" />
									</div>
									<span id="img-sex0" class='info-sex'>♂</span>
									<img id="avatar_img0" class='info-studenthead' src='img/head.png'>
									<input disabled id="st_name0" class='info-name' name='0' value='' placeholder="在此输入姓名" />
									<input disabled id="st_phone0" class='info-phone' type='number' value='' placeholder="输入手机号码" />
									<img class='img-charge' src='img/info-charge.png'>
									<p class='tittle-charge'>管理人</p>
									<input id="st_user_id0" disabled class='info-charge' value='同当前所登录管理者' />
									<img class='img-associatecollege' src='img/info-associatecollege.png'>
									<p class='tittle-associatecollege'>二级学院</p>
									<input id="st_as_id0" disabled class='info-associatecollege' value='同当前所登录管理者' />
									<img class='img-major' src='img/info-major.png'>
									<p class='tittle-major'>专业</p>
									<input id="st_ma_id0" disabled class='info-major' value='' placeholder="必输项" />
									<img class='img-register' src='img/info-register.png'>
									<p class='tittle-register'>登记时间</p>
									<input id="st_registerdate0" disabled class='info-register' value='同当前北京时间' />
									<img class='img-admission' src='img/info-admission.png'>
									<p class='tittle-admission'>入学时间</p>
									<input id="st_admissiondate0" disabled class='info-admission' value=''  placeholder="必输项"  />
									<img class='img-born' src='img/info-born.png'>
									<p class='tittle-born'>出生日期</p>
									<input id="st_born0" disabled class='info-born' value=''  placeholder="必输项"  />
									<img class='img-address' src='img/info-address.png'>
									<p class='tittle-address'>家庭住址</p>
									<input id="st_address0" disabled class='info-address' value=''  placeholder="必输项" />
									<div class='info-hr'></div>
									<img class='img-curriculum' src='img/info-curriculum.png'>
									<p class='tittle-curriculum'>所选课程</p>
									<div hidden id="curriculumadd0" class='info-curriculumadd'>
									<input type='text' id='test0'>
									<button id='add0' onClick='onclickByadd(0)'>添加</button>
								</div>
								<div id='div-curriculum0' class='div-curriculum'></div>
								<button class='personnel'>
									<img src='img/personnel.png'><br />资料
								</button>
								<button id='edit0' onClick='addStudent()' class='personnel-edit'>
									<img src='img/personnel-edit.png'><br /><span id='font-edit0'>保存</span>
								</button>
								<button onclick='chooseDelete(0)' class='personnel-delete'>
									<img src='img/personnel-delete.png'><br />删除
								</button>
							</div>
						</div>
					</div>
				</div>

				<div class="content">
					<div id="tableParent" >
						<script>
							var ip="localhost";
							//var ip="120.79.218.123";
							var tableParent = document.getElementById('tableParent');
							var xmlhttp = null;
							if (window.XMLHttpRequest) { // code for all new browsers
								xmlhttp = new XMLHttpRequest();
							} else if (window.ActiveXObject) { // code for IE5 and IE6
								xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
							}
							if (xmlhttp != null) {
								xmlhttp.onreadystatechange = state_Change;
								xmlhttp.open("POST", "http://"+ip+":8848/BootCMS/StudentList.action", true);
								xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
								//xmlhttp.setRequestHeader("Content-type","multipart/form-data");
								var ask = "st_id";
								var type = "1";
								xmlhttp.send("ask=" + ask + "&type=" + type);
							} else {
								alert("Your browser does not support XMLHTTP.");
							}
							function logout(){
								window.location.href="http://"+ip+":8848/BootCMS/Logout.action";
							}
							function screen(){
								var status=false;
								var st_name=document.getElementById('showName').innerHTML;
								var st_admissiondate=document.getElementById('showAdmissiondate').value;								
								var st_born=document.getElementById('showBorn').value;								
								var st_sex=document.getElementById('showSex').innerHTML;
								var st_ma_id=document.getElementById('showMajor').innerHTML;
								var st_phone=document.getElementById('showPhone').innerHTML;
								var json="{";
								if(st_name!=""){
									st_name=st_name.substring(1, st_name.length);
									json=json+"\"st_name\":\""+st_name+"\",";
									status=true;
								}
								if(st_admissiondate!=""){
									json=json+"\"st_admissiondate\":\""+st_admissiondate+"\",";
									status=true;
								}
								if(st_born!=""){
									json=json+"\"st_born\":\""+st_born+"\",";
									status=true;
								}
								if(st_sex!=""){
									st_sex=st_sex.substring(1, st_sex.length);
									json=json+"\"st_sex\":\""+st_sex+"\",";
									status=true;
								}
								if(st_ma_id!=""){
									st_ma_id=st_ma_id.substring(1, st_ma_id.length);
									json=json+"\"st_ma_id\":\""+st_ma_id+"\",";
									status=true;
								}
								if(st_phone!=""){
									st_phone=st_phone.substring(1, st_phone.length);
									json=json+"\"st_phone\":\""+st_phone+"\",";
									status=true;
								}
								if(status==true){
									json=json.substring(0, json.length-1);
									json=json+"}";
									if (xmlhttp != null) {
										xmlhttp.onreadystatechange = state_Change;
										xmlhttp.open("POST", "http://"+ip+":8848/BootCMS/StudentListScreen.action", true);
										xmlhttp.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
										//xmlhttp.setRequestHeader("Content-type","multipart/form-data");
										var ask = "st_id";
										var type = "0";
										xmlhttp.send("json="+json+"&ask=" + ask + "&type=" + type);
									} else {
										alert("Your browser does not support XMLHTTP.");
									}
								}
							}
							function state_Change() {
								if (xmlhttp.readyState == 4) { // 4 = "loaded"
									if (xmlhttp.status == 200) { // 200 = OK
										while(tableParent.hasChildNodes()){
											tableParent.removeChild(tableParent.firstChild);
										}
										if(xmlhttp.responseText=="null"){
											var p = document.createElement('p');
											p.innerHTML = "没有查询到数据！";
											tableParent.appendChild(p);
											return;
										}
										var array = JSON.parse(xmlhttp.responseText);
										for (var i = 0; i < array.length; i++) {
											var obj = array[i];
											var st_sc="";
											var img_sex="";
											if(obj.st_sex=="男"){
												img_sex="♂";
											}else{
												img_sex="♀";
											}
											if(obj.st_sc!=null){
												var data_st_sc=obj.st_sc;
												var list_st_sc=data_st_sc.split("~");
												for(var a=0;a<list_st_sc.length;a++){
													st_sc=st_sc+"<div id='container1-"+obj.st_id+"' style='width:auto;float:left;'><input disabled type='text' id='curriculum-output"
													+ obj.st_id + "' value='" + list_st_sc[a] + "' />"
													+ "<input hidden id='curriculum-delete" + obj.st_id
													+ "' type='button' class='delete' onclick='test(this)' value='&times;'/></div>";
												}
											}
											var div = document.createElement('div');
											div.style.float="left";
											div.id="studentCard"+obj.st_id;
											div.innerHTML = 
												"<br />"+
													"<div class='studentcard'>"+
														"<div class='info-head'>"+
															obj.st_ma_id+
														"</div>"+
														"<div class='info-body'>"+
															"<p>入学时间："+obj.st_admissiondate+"</p>"+
															"<p style='margin-top: -4%;'>出生年月："+obj.st_born+"</p>"+
														"</div>"+
														"<div class='info-footer'>"+
															"<img class='student-head' src='"+obj.st_image+"'>"+
																"<p class='student-name'>"+obj.st_name+"</p><span id='consloe-st_sex"+obj.st_id+"' class='badge badge-secondary badge-pill'>"+obj.st_sex+"</span>"+
																"<p class='student-phone'>"+obj.st_phone+"</p>"+
																"<button class='student-detail' data-toggle='modal' data-target='#info"+obj.st_id+"'>资料</button>"+
																	"<div id='info"+obj.st_id+"' class='modal fade'>"+
																		"<div class='modal-dialog'>"+
																			"<div class='modal-content'>"+
																				"<div class='modal-body2'>"+
																					"<button type='button' class='close2' onClick='closeCard("+obj.st_id+")' data-dismiss='modal'>&times;</button>"+
																						"<div class='info-studenthead-shadow'>"+
																							"<input hidden onChange='changeFile("+obj.st_id+")' type='file' id='avatar_file"+obj.st_id+"' name='avatar_file' accept='image/gif, image/jpg, image/jpeg, image/png'"+
																							" style='width: 100%;height:100%;opacity: 0;position: absolute;left:0;top: 0;' />"+
																						"</div>"+
																						"<span id='img-sex"+obj.st_id+"' class='info-sex'>"+
																						img_sex+
																						"</span>"+
																						"<img id='avatar_img"+obj.st_id+"' class='info-studenthead' src='"+obj.st_image+"'>"+
																						"<input disabled id='st_name"+obj.st_id+"' class='info-name' name='"+obj.st_id+"' value='"+obj.st_name+"' />"+
																						"<input disabled id='st_phone"+obj.st_id+"' class='info-phone' type='number' value='"+obj.st_phone+"' />"+
																						"<img class='img-charge' src='img/info-charge.png'>"+
																						"<p class='tittle-charge'>管理人</p><input id='st_user_id"+obj.st_id+"' disabled class='info-charge' value='"+obj.st_user_id+"' />"+
																						"<img class='img-associatecollege' src='img/info-associatecollege.png'>"+
																						"<p class='tittle-associatecollege'>二级学院</p><input id='st_as_id"+obj.st_id+"' disabled class='info-associatecollege'"+
																						" value='"+obj.st_as_id+"' />"+
																						"<img class='img-major' src='img/info-major.png'>"+
																							"<p class='tittle-major'>专业</p><input id='st_ma_id"+obj.st_id+"' disabled class='info-major' value='"+obj.st_ma_id+"' />"+
																							"<img class='img-register' src='img/info-register.png'>"+
																							"<p class='tittle-register'>登记时间</p><input id='st_registerdate"+obj.st_id+"' disabled class='info-register' value='"+obj.st_registerdate+"' />"+
																							"<img class='img-admission' src='img/info-admission.png'>"+
																							"<p class='tittle-admission'>入学时间</p><input id='st_admissiondate"+obj.st_id+"' disabled class='info-admission' value='"+obj.st_admissiondate+"' />"+
																							"<img class='img-born' src='img/info-born.png'>"+
																							"<p class='tittle-born'>出生日期</p><input id='st_born"+obj.st_id+"' disabled class='info-born' value='"+obj.st_born+"' />"+
																							"<img class='img-address' src='img/info-address.png'>"+
																							"<p class='tittle-address'>家庭住址</p><input id='st_address"+obj.st_id+"' disabled class='info-address' value='"+obj.st_address+"' />"+
																							"<div class='info-hr'></div>"+
																							"<img class='img-curriculum' src='img/info-curriculum.png'>"+
																							"<p class='tittle-curriculum'>所选课程</p>"+
																							"<div hidden id='curriculumadd"+obj.st_id+"' class='info-curriculumadd'>"+
																								"<input type='text' id='test"+obj.st_id+"'>"+
																								"<button id='add"+obj.st_id+"' onClick='onclickByadd("+obj.st_id+")'>添加</button>"+
																							"</div>"+
																							"<div id='div-curriculum"+obj.st_id+"' class='div-curriculum'>"+
																							st_sc+
																							"</div>"+
																							"<button class='personnel'>"+
																								"<img src='img/personnel.png'><br />资料"+
																							"</button>"+
																							"<button id='edit"+obj.st_id+"' onClick='onclickByedit("+obj.st_id+")' class='personnel-edit'>"+
																								"<img src='img/personnel-edit.png'><br /><span id='font-edit"+obj.st_id+"'>编辑</span>"+
																							"</button>"+
																							"<button onclick='chooseDelete("+obj.st_id+")' class='personnel-delete' data-dismiss='modal'>"+
																								"<img src='img/personnel-delete.png'><br />删除"+
																							"</button>"+
																						"</div>"+
																					"</div>"+
																				"</div>"+
																			"</div>"+
																		"</div>"+
																	"</div>";
											tableParent.appendChild(div);
										}
									} else {
										alert("Problem retrieving XML data");
									}
								}
							}
						</script>
					</div>
				</div>
			</div>
		</div>
	</body>
</html>
